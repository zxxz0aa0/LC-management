# 資料庫備份開發規劃

## 文件資訊
- **專案名稱**: LC-management (長照服務管理系統)
- **資料庫**: MySQL (透過 XAMPP)
- **框架**: Laravel 10.x
- **環境**: Windows + XAMPP
- **建立日期**: 2025-11-03
- **版本**: 1.0

---

## 1. 備份策略概覽

### 1.1 備份目標
- **資料完整性**: 確保所有關鍵業務資料可完整備份
- **快速復原**: 提供快速還原機制,最小化系統停機時間
- **版本管理**: 保留多個備份版本,支援時間點還原
- **安全性**: 備份檔案加密存儲,防止資料外洩

### 1.2 備份頻率
| 備份類型 | 執行頻率 | 保留期限 | 說明 |
|---------|---------|---------|------|
| 完整備份 | 每日凌晨 2:00 | 30 天 | 完整資料庫備份 |
| 週備份 | 每週日凌晨 3:00 | 12 週 (3個月) | 週度長期保存 |
| 月備份 | 每月 1 號凌晨 4:00 | 12 個月 (1年) | 月度長期保存 |
| 手動備份 | 依需求執行 | 永久保存 | 重大更新前手動備份 |

### 1.3 備份保留政策
```
storage/backups/
├── daily/          # 每日備份 (保留 30 天)
│   ├── lc_management_2025_11_01_020000.sql.gz
│   ├── lc_management_2025_11_02_020000.sql.gz
│   └── lc_management_2025_11_03_020000.sql.gz
├── weekly/         # 每週備份 (保留 12 週)
│   ├── lc_management_week_44_2025.sql.gz
│   └── lc_management_week_45_2025.sql.gz
├── monthly/        # 每月備份 (保留 12 個月)
│   ├── lc_management_2025_09.sql.gz
│   └── lc_management_2025_10.sql.gz
└── manual/         # 手動備份 (永久保存)
    ├── lc_management_before_v2_migration.sql.gz
    └── lc_management_before_carpool_feature.sql.gz
```

---

## 2. 備份內容與範圍

### 2.1 完整備份 (Full Backup)
備份所有資料表和資料,包含:

#### 核心業務資料表
- `orders` - 訂單資料 (含共乘群組資訊)
- `order_sequences` - 訂單序列號表 (併發控制關鍵表)
- `customers` - 客戶資料 (含 JSON 欄位)
- `drivers` - 司機資料
- `landmarks` - 地標資料

#### 系統與認證資料表
- `users` - 使用者帳號
- `password_reset_tokens` - 密碼重設權杖
- `personal_access_tokens` - API 權杖
- `sessions` - 使用者 Session

#### 歷史與追蹤資料表
- `customer_events` - 客戶事件記錄
- `import_sessions` - 匯入工作階段
- `import_progresses` - 匯入進度記錄

#### 佇列與任務資料表
- `jobs` - 待執行佇列任務
- `failed_jobs` - 失敗任務記錄

### 2.2 關鍵表單獨備份
對於資料變更頻繁且關鍵的表,額外建立單獨備份:

```bash
# 訂單表單獨備份 (每日多次)
mysqldump --single-transaction lc_management orders > orders_backup.sql

# 客戶表單獨備份
mysqldump --single-transaction lc_management customers > customers_backup.sql

# 司機表單獨備份
mysqldump --single-transaction lc_management drivers > drivers_backup.sql
```

### 2.3 結構備份 (Schema Only)
僅備份資料庫結構,不含資料,用於開發環境快速建立:

```bash
mysqldump --no-data lc_management > schema_only.sql
```

### 2.4 測試資料備份 (不含敏感資訊)
移除敏感欄位後的備份,用於測試環境:

```sql
-- 客戶資料去敏感化
UPDATE customers SET
    id_number = CONCAT('A', LPAD(id, 9, '0')),
    phones = JSON_ARRAY(CONCAT('0900', LPAD(id, 6, '0'))),
    addresses = JSON_ARRAY('測試地址');

-- 司機資料去敏感化
UPDATE drivers SET
    phone = CONCAT('0900', LPAD(id, 6, '0')),
    license_plate = CONCAT('ABC-', LPAD(id, 4, '0'));
```

---

## 3. 技術實作方案

### 3.1 Laravel Artisan 備份命令

由於篇幅較長,完整的 Laravel Artisan 命令程式碼請參考以下結構:

#### 建立備份命令
位置: `app/Console/Commands/DatabaseBackup.php`

**主要功能**:
- 支援完整備份、結構備份、指定表備份
- 自動壓縮備份檔案 (gzip)
- 可選加密功能
- 自動清理過期備份

#### 建立還原命令
位置: `app/Console/Commands/DatabaseRestore.php`

**主要功能**:
- 從備份檔案還原資料庫
- 自動解壓縮 .gz 檔案
- 還原前確認機制

### 3.2 排程任務設定

#### Laravel Task Scheduling
在 `app/Console/Kernel.php` 中設定:

```php
protected function schedule(Schedule $schedule)
{
    // 每日備份 (凌晨 2:00)
    $schedule->command('db:backup --type=full --compress')
             ->dailyAt('02:00');

    // 每週備份 (週日凌晨 3:00)
    $schedule->command('db:backup --type=full --compress')
             ->weeklyOn(0, '03:00');

    // 每月備份 (每月 1 號凌晨 4:00)
    $schedule->command('db:backup --type=full --compress')
             ->monthlyOn(1, '04:00');

    // 關鍵表額外備份 (每 6 小時)
    $schedule->command('db:backup --type=tables --tables=orders,customers,drivers --compress')
             ->everySixHours();
}
```

#### Windows Task Scheduler 設定
針對 XAMPP 環境,使用 Windows 工作排程器:

**建立批次腳本**: `database_backup.bat`
```batch
@echo off
REM LC-management 資料庫備份腳本
REM 請將此檔案放置於專案根目錄

set BACKUP_DIR=C:\xampp\htdocs\LC-management\storage\backups\daily
set DB_NAME=lc_management
set DB_USER=root
set DB_PASS=
set TIMESTAMP=%date:~0,4%%date:~5,2%%date:~8,2%_%time:~0,2%%time:~3,2%%time:~6,2%
set TIMESTAMP=%TIMESTAMP: =0%
set BACKUP_FILE=%BACKUP_DIR%\%DB_NAME%_%TIMESTAMP%.sql

REM 確保備份目錄存在
if not exist "%BACKUP_DIR%" mkdir "%BACKUP_DIR%"

REM 執行備份
cd C:\xampp\mysql\bin
mysqldump -u%DB_USER% --password=%DB_PASS% --single-transaction %DB_NAME% > "%BACKUP_FILE%"

REM 壓縮備份檔案 (需安裝 7-Zip)
"C:\Program Files\7-Zip\7z.exe" a -tgzip "%BACKUP_FILE%.gz" "%BACKUP_FILE%"
del "%BACKUP_FILE%"

REM 清理超過 30 天的備份
forfiles /p "%BACKUP_DIR%" /s /m *.gz /d -30 /c "cmd /c del @path"

echo Backup completed: %BACKUP_FILE%.gz
```

**設定 Windows 工作排程器**:
```powershell
# 使用 PowerShell 建立排程任務
$action = New-ScheduledTaskAction -Execute "C:\xampp\htdocs\LC-management\database_backup.bat"
$trigger = New-ScheduledTaskTrigger -Daily -At 2am
$principal = New-ScheduledTaskPrincipal -UserId "SYSTEM" -LogonType ServiceAccount -RunLevel Highest
$settings = New-ScheduledTaskSettingsSet -StartWhenAvailable -DontStopIfGoingOnBatteries

Register-ScheduledTask -TaskName "LC-Management Daily Backup" -Action $action -Trigger $trigger -Principal $principal -Settings $settings -Description "每日資料庫備份"
```

### 3.3 備份腳本集合

#### 快速備份腳本 (quick_backup.bat)
```batch
@echo off
REM 快速手動備份腳本
set DB_NAME=lc_management
set BACKUP_FILE=C:\xampp\htdocs\LC-management\storage\backups\manual\%DB_NAME%_manual_%date:~0,4%%date:~5,2%%date:~8,2%.sql

cd C:\xampp\mysql\bin
mysqldump -uroot --single-transaction %DB_NAME% > "%BACKUP_FILE%"

echo Manual backup completed: %BACKUP_FILE%
pause
```

#### 結構備份腳本 (schema_backup.bat)
```batch
@echo off
REM 僅備份資料庫結構
set DB_NAME=lc_management
set SCHEMA_FILE=C:\xampp\htdocs\LC-management\storage\backups\schema_only.sql

cd C:\xampp\mysql\bin
mysqldump -uroot --no-data %DB_NAME% > "%SCHEMA_FILE%"

echo Schema backup completed: %SCHEMA_FILE%
pause
```

#### 關鍵表備份腳本 (critical_tables_backup.bat)
```batch
@echo off
REM 備份關鍵業務資料表
set DB_NAME=lc_management
set TIMESTAMP=%date:~0,4%%date:~5,2%%date:~8,2%_%time:~0,2%%time:~3,2%
set TIMESTAMP=%TIMESTAMP: =0%

cd C:\xampp\mysql\bin

REM 備份訂單表
mysqldump -uroot --single-transaction %DB_NAME% orders > "C:\xampp\htdocs\LC-management\storage\backups\critical\orders_%TIMESTAMP%.sql"

REM 備份客戶表
mysqldump -uroot --single-transaction %DB_NAME% customers > "C:\xampp\htdocs\LC-management\storage\backups\critical\customers_%TIMESTAMP%.sql"

REM 備份司機表
mysqldump -uroot --single-transaction %DB_NAME% drivers > "C:\xampp\htdocs\LC-management\storage\backups\critical\drivers_%TIMESTAMP%.sql"

echo Critical tables backup completed
pause
```

---

## 4. 備份驗證機制

### 4.1 備份完整性檢查

建議建立驗證命令 (`app/Console/Commands/VerifyBackup.php`) 來檢查:
- 檔案大小是否合理
- 檔案是否可讀取
- SQL 檔案基本結構檢查
- 關鍵資料表是否存在

### 4.2 自動化驗證流程

在備份完成後自動執行驗證,確保備份檔案可用。

---

## 5. 還原流程與災難復原

### 5.1 完整還原流程

#### 步驟 1: 評估備份檔案
```bash
# 列出可用備份
php artisan db:list-backups

# 驗證備份檔案
php artisan db:verify-backup storage/backups/daily/lc_management_2025_11_03_020000.sql.gz
```

#### 步驟 2: 備份當前資料庫 (安全措施)
```bash
# 在還原前先備份當前狀態
php artisan db:backup --type=full --compress
```

#### 步驟 3: 執行還原
```bash
# 還原完整備份
php artisan db:restore storage/backups/daily/lc_management_2025_11_03_020000.sql.gz

# 或使用 mysqldump 手動還原
cd C:\xampp\mysql\bin
mysql -uroot lc_management < "C:\xampp\htdocs\LC-management\storage\backups\daily\lc_management_2025_11_03_020000.sql"
```

#### 步驟 4: 驗證還原結果
```bash
# 執行資料庫遷移檢查
php artisan migrate:status

# 檢查關鍵資料表記錄數
php artisan tinker
>>> DB::table('orders')->count()
>>> DB::table('customers')->count()
>>> DB::table('drivers')->count()

# 清除所有快取
php artisan optimize:clear
```

### 5.2 部分表還原

有時只需要還原特定資料表:

```bash
# 從完整備份中提取特定表
sed -n '/CREATE TABLE `orders`/,/UNLOCK TABLES;/p' backup.sql > orders_only.sql

# 還原單一資料表
mysql -uroot lc_management < orders_only.sql
```

### 5.3 災難復原計畫 (Disaster Recovery Plan)

#### 情境 1: 資料庫完全損壞
```
1. 停止 Apache 和 MySQL 服務
2. 從最近的完整備份還原
3. 驗證資料完整性
4. 重新啟動服務
5. 執行系統測試
```

#### 情境 2: 部分資料損壞或誤刪除
```
1. 識別問題範圍 (哪些表/記錄受影響)
2. 從備份中提取受影響的表
3. 比對差異,確認還原範圍
4. 執行部分還原
5. 驗證資料一致性
```

#### 情境 3: 共乘群組資料損壞 (特殊情境)
由於 LC-management 系統具有複雜的共乘群組關聯:

```sql
-- 驗證共乘群組資料完整性
SELECT
    carpool_group_id,
    COUNT(*) as member_count,
    SUM(CASE WHEN is_main_order = 1 THEN 1 ELSE 0 END) as main_orders
FROM orders
WHERE carpool_group_id IS NOT NULL
GROUP BY carpool_group_id
HAVING main_orders != 1 OR member_count != MAX(carpool_member_count);

-- 如發現不一致,從備份還原 orders 表
```

### 5.4 復原時間目標 (RTO) 與復原點目標 (RPO)

| 指標 | 目標值 | 說明 |
|-----|-------|------|
| RTO (Recovery Time Objective) | < 1 小時 | 系統完全恢復運作的時間 |
| RPO (Recovery Point Objective) | < 24 小時 | 可接受的資料損失範圍 |
| 備份驗證時間 | < 5 分鐘 | 備份完整性驗證時間 |
| 部分還原時間 | < 15 分鐘 | 單一資料表還原時間 |

---

## 6. 儲存與安全策略

### 6.1 本地儲存配置

#### 目錄結構
```
storage/backups/
├── daily/              # 每日備份 (30 天)
├── weekly/             # 每週備份 (12 週)
├── monthly/            # 每月備份 (12 個月)
├── manual/             # 手動備份 (永久)
├── critical/           # 關鍵表備份 (7 天)
└── schema/             # 結構備份 (最新版本)
```

#### 權限設定
```bash
# Linux/macOS
chmod 700 storage/backups/
chmod 600 storage/backups/**/*.sql*

# Windows (使用 icacls)
icacls "C:\xampp\htdocs\LC-management\storage\backups" /inheritance:r /grant:r "%USERNAME%:(OI)(CI)F"
```

### 6.2 壓縮與加密

#### 壓縮備份 (使用 gzip)
```bash
# 壓縮備份檔案 (可減少 70-90% 大小)
gzip backup.sql

# 解壓縮
gunzip backup.sql.gz
```

#### 加密備份 (使用 OpenSSL)
```bash
# 加密備份檔案
openssl enc -aes-256-cbc -salt -in backup.sql -out backup.sql.enc -k "your_strong_password"

# 解密備份檔案
openssl enc -aes-256-cbc -d -in backup.sql.enc -out backup.sql -k "your_strong_password"
```

#### 整合壓縮與加密
```bash
# 備份 -> 壓縮 -> 加密
mysqldump -uroot lc_management | gzip | openssl enc -aes-256-cbc -salt -out backup.sql.gz.enc -k "password"

# 解密 -> 解壓縮 -> 還原
openssl enc -aes-256-cbc -d -in backup.sql.gz.enc -k "password" | gunzip | mysql -uroot lc_management
```

### 6.3 遠端備份方案

#### 方案 1: Google Drive 同步
使用 `rclone` 或 Google Drive 備份工具:

```bash
# 安裝 rclone (Windows)
# 下載: https://rclone.org/downloads/

# 設定 Google Drive
rclone config

# 同步備份到雲端
rclone sync "C:\xampp\htdocs\LC-management\storage\backups" gdrive:LC-Management-Backups
```

#### 方案 2: FTP/SFTP 傳輸
```php
// Laravel 檔案系統設定 (config/filesystems.php)
'disks' => [
    'ftp_backup' => [
        'driver' => 'ftp',
        'host' => env('FTP_HOST'),
        'username' => env('FTP_USERNAME'),
        'password' => env('FTP_PASSWORD'),
        'root' => '/backups',
    ],
],

// 上傳備份到 FTP
Storage::disk('ftp_backup')->put('backup.sql.gz', file_get_contents($localBackupPath));
```

#### 方案 3: AWS S3 / Azure Blob Storage
```php
// config/filesystems.php
'disks' => [
    's3_backup' => [
        'driver' => 's3',
        'key' => env('AWS_ACCESS_KEY_ID'),
        'secret' => env('AWS_SECRET_ACCESS_KEY'),
        'region' => env('AWS_DEFAULT_REGION'),
        'bucket' => env('AWS_BACKUP_BUCKET'),
    ],
],
```

### 6.4 備份檔案命名規範

```
格式: {database}_{type}_{timestamp}.sql[.gz][.enc]

範例:
- lc_management_full_2025_11_03_020000.sql.gz
- lc_management_schema_2025_11_03.sql
- lc_management_tables_orders_2025_11_03_140000.sql.gz
- lc_management_manual_before_v2_migration.sql.gz.enc
```

---

## 7. 監控與通知機制

### 7.1 備份狀態監控

建議建立監控命令 (`app/Console/Commands/MonitorBackups.php`) 來檢查:
- 是否有最近 24 小時內的備份
- 備份檔案大小是否合理
- 儲存空間是否充足
- 備份數量是否符合預期

### 7.2 自動化監控排程

在 `app/Console/Kernel.php` 加入:

```php
// 每小時檢查備份狀態
$schedule->command('db:monitor-backups')
         ->hourly();

// 每天早上 9:00 發送備份狀態報告
$schedule->command('db:monitor-backups --alert')
         ->dailyAt('09:00');
```

### 7.3 郵件通知設定

可建立備份通知 Mail 類別,在備份成功或失敗時發送郵件通知給系統管理員。

### 7.4 Slack 通知整合 (可選)

```bash
# 安裝 Slack 通知套件
composer require laravel/slack-notification-channel
```

---

## 8. 開發指令速查表

### 8.1 備份指令

```bash
# 完整備份 (含壓縮)
php artisan db:backup --type=full --compress

# 僅備份結構
php artisan db:backup --type=schema

# 備份特定資料表
php artisan db:backup --type=tables --tables=orders,customers,drivers

# 備份並加密
php artisan db:backup --type=full --compress --encrypt

# 手動快速備份 (Windows)
cd C:\xampp\mysql\bin
mysqldump -uroot lc_management > C:\xampp\htdocs\LC-management\storage\backups\manual\backup_%date:~0,10%.sql
```

### 8.2 還原指令

```bash
# 從備份還原
php artisan db:restore storage/backups/daily/lc_management_2025_11_03_020000.sql.gz

# 手動還原 (Windows)
cd C:\xampp\mysql\bin
mysql -uroot lc_management < C:\xampp\htdocs\LC-management\storage\backups\daily\lc_management_2025_11_03_020000.sql

# 還原壓縮備份 (Linux/Mac)
gunzip < backup.sql.gz | mysql -uroot lc_management
```

### 8.3 驗證與監控指令

```bash
# 驗證備份檔案
php artisan db:verify-backup storage/backups/daily/backup.sql.gz

# 監控備份狀態
php artisan db:monitor-backups

# 監控並發送警報
php artisan db:monitor-backups --alert

# 列出所有備份
php artisan db:list-backups
```

### 8.4 維護指令

```bash
# 清理舊備份 (超過 30 天)
find storage/backups/daily -name "*.sql*" -mtime +30 -delete

# 清理舊備份 (Windows)
forfiles /p "C:\xampp\htdocs\LC-management\storage\backups\daily" /s /m *.sql* /d -30 /c "cmd /c del @path"

# 檢查儲存空間
df -h storage/backups/  # Linux/Mac
dir "C:\xampp\htdocs\LC-management\storage\backups"  # Windows

# 計算備份總大小
du -sh storage/backups/*  # Linux/Mac
```

---

## 9. 測試與驗證

### 9.1 備份還原測試計畫

建議每季度執行一次完整的備份還原測試:

#### 測試步驟
```bash
# 1. 建立測試資料庫
mysql -uroot -e "CREATE DATABASE lc_management_test;"

# 2. 執行備份
php artisan db:backup --type=full --compress

# 3. 還原到測試資料庫
mysql -uroot lc_management_test < storage/backups/daily/latest_backup.sql

# 4. 驗證資料一致性
php artisan tinker
>>> DB::connection('mysql')->table('orders')->count()
>>> DB::connection('mysql_test')->table('orders')->count()

# 5. 清理測試資料庫
mysql -uroot -e "DROP DATABASE lc_management_test;"
```

### 9.2 災難復原演練

**演練情境**: 模擬生產資料庫損壞,需完整復原

```bash
# 記錄開始時間
echo "演練開始時間: $(date)"

# 步驟 1: 停止服務 (模擬)
# 在生產環境應執行: php artisan down

# 步驟 2: 識別最新備份
ls -lh storage/backups/daily/ | tail -5

# 步驟 3: 驗證備份
php artisan db:verify-backup storage/backups/daily/latest.sql.gz

# 步驟 4: 執行還原
php artisan db:restore storage/backups/daily/latest.sql.gz

# 步驟 5: 驗證資料
php artisan tinker
>>> DB::table('orders')->count()

# 步驟 6: 恢復服務 (模擬)
# 在生產環境應執行: php artisan up

# 記錄結束時間並計算復原時間
echo "演練結束時間: $(date)"
```

---

## 10. 常見問題與排除

### Q1: 備份檔案過大,如何優化?

**解答**:
```bash
# 1. 使用壓縮 (可減少 70-90% 大小)
php artisan db:backup --compress

# 2. 排除不重要的表
mysqldump -uroot lc_management --ignore-table=lc_management.sessions --ignore-table=lc_management.jobs > backup.sql

# 3. 僅備份最近 90 天的資料
mysqldump -uroot lc_management orders --where="ride_date >= DATE_SUB(NOW(), INTERVAL 90 DAY)" > orders_recent.sql
```

### Q2: mysqldump 執行很慢怎麼辦?

**解答**:
```bash
# 使用 --single-transaction 避免鎖表 (InnoDB)
mysqldump -uroot --single-transaction lc_management > backup.sql

# 使用 --quick 選項減少記憶體使用
mysqldump -uroot --quick --single-transaction lc_management > backup.sql

# 排除大型不重要的表
mysqldump -uroot --ignore-table=lc_management.logs lc_management > backup.sql
```

### Q3: 還原時出現字元編碼錯誤?

**解答**:
```bash
# 確保使用正確的字元編碼
mysql -uroot --default-character-set=utf8mb4 lc_management < backup.sql

# 或在備份時指定編碼
mysqldump -uroot --default-character-set=utf8mb4 lc_management > backup.sql
```

### Q4: Windows Task Scheduler 排程未執行?

**解答**:
1. 檢查使用者權限 (應使用 SYSTEM 帳戶)
2. 確認批次腳本路徑正確且可執行
3. 查看工作排程器的歷史記錄
4. 測試手動執行批次腳本是否正常

### Q5: 如何確認備份是否包含所有資料?

**解答**:
```bash
# 驗證備份檔案
php artisan db:verify-backup storage/backups/daily/backup.sql.gz

# 檢查備份檔案的表數量
grep -c "CREATE TABLE" backup.sql

# 檢查特定表是否存在
grep "CREATE TABLE \`orders\`" backup.sql
```

---

## 11. 進階主題

### 11.1 增量備份 (Incremental Backup)

MySQL 二進制日誌 (Binary Log) 增量備份:

```bash
# 啟用二進制日誌 (my.ini 或 my.cnf)
[mysqld]
log-bin=mysql-bin
expire_logs_days=7

# 刷新日誌
mysql -uroot -e "FLUSH LOGS;"

# 備份二進制日誌
mysqlbinlog mysql-bin.000001 > binlog_backup.sql

# 還原增量備份
mysql -uroot lc_management < binlog_backup.sql
```

### 11.2 主從複製 (Replication) 作為備份策略

```sql
-- 在主伺服器設定
CREATE USER 'repl'@'slave_ip' IDENTIFIED BY 'password';
GRANT REPLICATION SLAVE ON *.* TO 'repl'@'slave_ip';

-- 在從伺服器設定
CHANGE MASTER TO
    MASTER_HOST='master_ip',
    MASTER_USER='repl',
    MASTER_PASSWORD='password',
    MASTER_LOG_FILE='mysql-bin.000001',
    MASTER_LOG_POS=107;

START SLAVE;
```

### 11.3 自動化測試備份可還原性

可建立自動化測試來驗證備份和還原功能是否正常運作。

---

## 12. 檢查清單 (Checklist)

### 初次設定檢查清單
- [ ] 建立備份目錄結構 (`storage/backups/`)
- [ ] 設定目錄權限 (700 for directory, 600 for files)
- [ ] 測試 mysqldump 命令可正常執行
- [ ] 建立 Laravel Artisan 備份命令
- [ ] 設定 Laravel Task Scheduling
- [ ] 配置 Windows Task Scheduler (XAMPP 環境)
- [ ] 測試手動備份和還原
- [ ] 設定備份監控機制
- [ ] 配置通知系統 (郵件/Slack)
- [ ] 執行首次災難復原演練

### 每月檢查清單
- [ ] 驗證自動備份正常執行
- [ ] 檢查備份檔案大小和數量
- [ ] 清理過期備份檔案
- [ ] 檢查儲存空間使用狀況
- [ ] 測試最新備份的還原功能
- [ ] 檢查備份日誌和錯誤記錄
- [ ] 更新備份文檔和流程

### 每季檢查清單
- [ ] 執行完整災難復原演練
- [ ] 測試遠端備份同步功能
- [ ] 審查備份保留政策
- [ ] 檢查備份安全性設定
- [ ] 更新備份腳本和命令
- [ ] 培訓相關人員備份還原流程

---

## 13. 參考資源

### 官方文件
- [MySQL 備份與還原](https://dev.mysql.com/doc/refman/8.0/en/backup-and-recovery.html)
- [Laravel Task Scheduling](https://laravel.com/docs/10.x/scheduling)
- [mysqldump 完整參數說明](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html)

### 工具下載
- [7-Zip (Windows 壓縮工具)](https://www.7-zip.org/)
- [rclone (雲端同步工具)](https://rclone.org/)
- [MySQL Workbench (資料庫管理)](https://www.mysql.com/products/workbench/)

### 相關專案文件
- `CLAUDE.md` - 專案整體說明
- `EXCEL_匯入格式規格說明.md` - Excel 匯入規格
- `共乘單方案.md` - 共乘功能設計

---

## 14. 版本更新記錄

| 版本 | 日期 | 更新內容 |
|-----|------|---------|
| 1.0 | 2025-11-03 | 初版建立,包含完整備份策略與實作方案 |

---

## 15. 聯絡資訊與支援

如有備份相關問題或建議,請聯絡系統管理員。

**緊急聯絡**: 當資料庫備份或還原遇到問題時,請立即聯絡技術團隊。

---

*本文件應定期更新,確保與系統實際狀況同步*
